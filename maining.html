<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dark Magic Ai Bot - Main</title>

<link href="https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600&display=swap" rel="stylesheet">

<style>
    body {
        background: black;
        color: white;
        font-family: Arial, sans-serif;
        text-align: center;
        padding: 10px;
    }

    h1 {
        font-family: 'UnifrakturCook', cursive;
        font-size: 35px;
        color: red;
        margin-bottom: 5px;
    }

    .grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        padding-top: 20px;
    }

    .game-button img {
        width: 100%;
        max-width: 160px;
        height: 160px;
        border-radius: 20px;
        object-fit: cover;
        border: 3px solid red;
        opacity: 0.3;
        pointer-events: none;
        transition: .2s;
    }

    .label {
        font-family: 'UnifrakturCook', cursive;
        margin-top: 5px;
        color: cyan;
        font-size: 20px;
    }

    button {
        width: 92%;
        padding: 14px;
        background: #e60000;
        font-family: 'Poppins', sans-serif;
        font-size: 18px;
        color: #ffffff;
        font-weight: 600;
        border-radius: 10px;
        border: none;
        margin-top: 12px;
        cursor: pointer;
        letter-spacing: 0.5px;
        transition: 0.3s ease-in-out;
        box-shadow: 0 0 18px rgba(255, 0, 0, 0.7);
    }

    button:hover {
        box-shadow: 0 0 25px rgba(255, 0, 0, 1);
    }

    button:active {
        background: #b30000;
    }

    input {
        width: 90%;
        padding: 12px;
        font-size: 18px;
        margin-top: 10px;
        border-radius: 8px;
        border: none;
    }

    #toast {
        visibility: hidden;
        min-width: 240px;
        background-color: red;
        font-family: 'Poppins', sans-serif;
        color: black;
        text-align: center;
        border-radius: 10px;
        padding: 12px;
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 18px;
        z-index: 99999;
        opacity: 0;
        transition: opacity 0.3s, bottom 0.3s;
    }

    #toast.show {
        visibility: visible;
        opacity: 1;
        bottom: 50px;
    }

    #statusMessage {
        margin-top: 12px;
        font-size: 19px;
        color: yellow;
    }

    #instructionText {
        font-size: 18px;
        font-family: 'Poppins', sans-serif;
        color: orange;
        margin-bottom: 15px;
    }

    /* Wrap all registration elements in a container */
    #registrationContainer {
        margin-bottom: 20px;
    }
</style>
</head>

<body>

<h1>Dark Magic Ai Bot</h1>

<p id="statusMessage">Checking approval status...</p>

<div id="registrationContainer">
    <p id="instructionText">
        Click REGISTER below to create a new account ✅<br>
        Then enter your NEW 1Win ID here to unlock the app 🔓
    </p>

    <button id="registerBtn" onclick="window.open('https://lkxw.cc/9e8cb290', '_blank')">
        ✅ Register with Official Link
    </button>

    <input type="number" id="oneWinID" placeholder="Enter Your New 1Win Account ID">
    <button id="submitIDBtn" onclick="submitID()">📩 Submit New ID</button>
</div>

<div class="grid">
    <div class="game-button" id="luckyJetBtn">
        <img src="lucky.jpg" alt="Lucky Jet">
        <div class="label">Lucky Jet</div>
    </div>

    <div class="game-button" id="aviatorBtn">
        <img src="aviator.jpg" alt="Aviator">
        <div class="label">Aviator</div>
    </div>

    <div class="game-button" id="minesBtn">
        <img src="mine.jpg" alt="Mines">
        <div class="label">Mines</div>
    </div>

    <div class="game-button" id="rocketBtn">
        <img src="rocket.jpg" alt="Rocket Queen">
        <div class="label">Rocket Queen</div>
    </div>
</div>

<div id="toast"></div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyDvFDByPPo9zgwKLdPaREz1OVMQCXmPfrs",
    authDomain: "bets-d795d.firebaseapp.com",
    projectId: "bets-d795d",
    storageBucket: "bets-d795d.appspot.com",
    messagingSenderId: "384386108287",
    appId: "1:384386108287:android:d238a5ec8068d9bb9be84a",
    databaseURL: "https://bets-d795d-default-rtdb.firebaseio.com"
};
firebase.initializeApp(firebaseConfig);

let approvalStatus = null;
const db = firebase.database();

firebase.auth().onAuthStateChanged(user => {
    if (!user) {
        window.location.href = "login.html";
    } else {
        checkStatus(user.uid);
    }
});

function toast(msg) {
    let t = document.getElementById("toast");
    t.innerHTML = msg;
    t.className = "show";
    setTimeout(() => { t.className = t.className.replace("show", ""); }, 2500);
}

function handleGameClick(page) {
    if (approvalStatus !== "approved") {
        toast("Register a new account first!");
        return;
    }
    toast("Loading…");
    setTimeout(() => {
        location.href = page;
    }, 2000);
}

document.getElementById("luckyJetBtn").onclick = () => handleGameClick('lucky.html');
document.getElementById("aviatorBtn").onclick = () => handleGameClick('aviator.html');
document.getElementById("minesBtn").onclick = () => toast("🚫 Server Unavailable");
document.getElementById("rocketBtn").onclick = () => toast("🚫 Server Unavailable");

function submitID() {
    const user = firebase.auth().currentUser;
    const id = document.getElementById("oneWinID").value;

    if (!id) return toast("Enter your 1Win ID");

    db.ref("users/" + user.uid).update({
        email: user.email,
        oneWinID: id,
        status: "pending"
    });

    toast("ID Submitted — Wait for approval");
    checkStatus(user.uid);
}

function checkStatus(uid) {
    const instruction = document.getElementById("instructionText");
    const registrationContainer = document.getElementById("registrationContainer");

    db.ref("users/" + uid).on("value", snap => {
        let data = snap.val();
        if (!data || !data.status) {
            approvalStatus = "none";
            document.getElementById("statusMessage").innerHTML = "🚫 Submit your ID to continue";
            lockButtons();
            registrationContainer.style.display = "block";
        } else {
            approvalStatus = data.status;

            if (data.status === "pending") {
                document.getElementById("statusMessage").innerHTML = "⏳ Approval Pending...";
                lockButtons();
                registrationContainer.style.display = "block";
            }
            else if (data.status === "declined") {
                document.getElementById("statusMessage").innerHTML = "❌ Register using our official link!";
                lockButtons();
                registrationContainer.style.display = "block";
            }
            else if (data.status === "approved") {
                document.getElementById("statusMessage").innerHTML = "✅ Approved — You can play!";
                unlockButtons();
                registrationContainer.style.display = "none"; // hide registration elements
            }
        }
    });
}

function lockButtons() {
    document.querySelectorAll(".game-button img").forEach(i => {
        i.style.opacity = "0.3";
        i.style.pointerEvents = "none";
    });
}

function unlockButtons() {
    document.querySelectorAll(".game-button img").forEach(i => {
        i.style.opacity = "1";
        i.style.pointerEvents = "auto";
    });
}
</script>

</body>
</html>